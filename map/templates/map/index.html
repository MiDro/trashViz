{% load static %}

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<link rel="stylesheet" type="text/css" href="{% static 'map/style.css' %}" />

{% if latest_trash_list %}

	<table class="table">
	{% for bin in latest_trash_list %}
		<tr>
			<td>
				{{bin.name}}
			</td>
			<td>
				{{bin.trashID}}
			</td>
			<td>
				{% if bin.status == True %}
				<span id="work">Working</span>
				{% else %}
				<span id="broke">Broken</span>
				{% endif %}
			</td>
			<td>
				{{bin.fillLevel}}
			</td>
			<td>
				{{bin.location}}
			</td>
			<td>
				<a href="{% url 'map:detail' bin.id %}"> {{bin.info}}</a>
			</td>
			<td>
				{{bin.latitude}}, {{bin.longitude}}
			</td>
		</tr>
	{% endfor %}
	</table>
	{% comment "optional note" %}
		<p>
			Have fun
		</p>
	{% endcomment %}
{% else %}
	<p> No polls are available. </p>
{% endif %}

<div id="map"></div>
<script type="text/javascript">
	var lats = [{% for bin in latest_trash_list %} "{{bin.latitude}}", {% endfor %}];
	var longs= [{% for bin in latest_trash_list %} "{{bin.longitude}}", {% endfor %}];
	var i;
	var uluru = {lat: 37.724930, lng: -122.156077};

	function initMap() {
	  var map = new google.maps.Map(document.getElementById('map'), {
	    zoom: 11,
	    center: uluru
	  });
		var marker = new google.maps.Marker({
	    position: uluru,
	    map: map
	  });    
	  for(i=0; i < lats.length; i++){
	  	new google.maps.Marker({
		    position: {lat: parseFloat(lats[i]), lng: parseFloat(longs[i])},
		    map: map
		  });    
	  }
	}
</script>

{# <script src="{% static 'map/map.js' %}"></script> #}
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDoEb0tARxCjuVZjJcskuadE9nmVyCjgs&callback=initMap"></script>